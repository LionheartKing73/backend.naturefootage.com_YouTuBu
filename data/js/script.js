function detectLocale() {    var detectedLocale;    var defaultLocale = 'en';    // get by meta    var metas = document.getElementsByTagName('meta');    for (var i = 0; i < metas.length; i++) {        if (metas[i].attributes['http-equiv'] && metas[i].attributes['http-equiv'].nodeValue.toLowerCase() == 'content-language') {            detectedLocale = metas[i].attributes['content'].nodeValue;        }    }    if (!detectedLocale) detectedLocale = defaultLocale;    return detectedLocale;}function deSelectAllClips() {    var clipInputs = $('.footagesearch-clip-input');    var clipCheckboxes = $('input[name="id[]"]');    var clips = $('.footagesearch-clip');    clipInputs.val(0);    clipCheckboxes.attr('checked', false);    clipInputs.parents('.footagesearch-clip').removeClass('selected');    clips.draggable('disable');}//jQuery.i18n.properties({//    name:'site',//    path:'data/js/langs/',//    mode:'both',//    language:detectLocale()//});function change_action(myForm, action) {    if (action) {        if ((action.indexOf("delete") > 0) && !confirm("The selected item(s) will be deleted."))            return;        myForm.action = action;    }    myForm.submit();    deSelectAllClips();}function select_all(myForm) {    var selection = true;    var name = 'id[]';    for (i = 0; i < myForm.elements.length; i++) {        if (myForm.elements[i].name == name) {            if (myForm.elements[i].checked == false)                selection = myForm.elements[i].checked;        }    }    for (i = 0; i < myForm.elements.length; i++) {        if (myForm.elements[i].name == name) myForm.elements[i].checked = !selection;    }    return false;}function check_selected(myForm, element) {    i = 0;    flag = false;    while (i < myForm.elements.length && !flag) {        if (myForm.elements[i].name == element && myForm.elements[i].checked == true) flag = true;        i++;    }    if (!flag) alert('No object was selected for action!');    return flag;}function check_selected_count(myForm, element) {    i = 0;    j = 0;    flag = false;    while (i < myForm.elements.length && !flag) {        if (myForm.elements[i].name == element && myForm.elements[i].checked == true) {            j++;        }        i++;    }    return j;}var itemAdded = false;function loginPopup() {    $("#loginPopup").dialog({        title: jQuery.i18n.prop('login_form_title'),        width: 250,        height: 250,        position: ["center", "center"],        modal: true,        resizable: false,        zIndex: 3999    });}function loginUser() {    var form = $('#auth');    action = form.attr('action');    url = (typeof action === 'string') ? $.trim(action) : '';    url = url || window.location.href || '';    if (url) {        // clean url (don't include hash vaue)        url = (url.match(/^([^#]+)/) || [])[1];    }    $.ajax({        url: url,        dataType: 'json',        type: 'POST',        data: 'enter=1&login=' + $('#auth #login').val() + '&password=' + $('#auth #password').val(),        success: function (data, textStatus) {            if (data.status == 1) {                window.location.href = window.location.href;            }            else {                $('#loginPopup .message').html(data.error).show();            }        }    });}/* Create player */function selectPlayMethod() {    if ((window.navigator.userAgent.indexOf("iPad") != -1) ||        (window.navigator.userAgent.indexOf("iPhone") != -1) /*||     (window.navigator.userAgent.indexOf("Mac OS X") != -1)*/) {        return "QT";    }    return "flash";}function createPlayer(movieUrl, videoWidth, videoHeight, containerId,                      hideControl, autostart) {    var playMethod = selectPlayMethod();    var autoplay = autostart ? "true" : "false";    if (playMethod == 'QT') {        var controller = hideControl ? "false" : "true";        if (!hideControl && (window.navigator.userAgent.indexOf("iP") == -1)) {            videoHeight += 16;        }        var qtContent = QT_GenerateOBJECTText(movieUrl, videoWidth, videoHeight, "",            "controller", controller, "autoplay", autoplay, "scale", "aspect", "bgcolor",            "black", "wmode", "opaque",            "obj#ID", containerId + "_qtobj", "emb#ID", containerId + "_qtembed");        $("#" + containerId).html(qtContent);    } else if (playMethod == 'flash') {        var controlBarHeight = hideControl ? 0 : 22;        var so = new SWFObject("/data/swf/player.swf", containerId + '_flash',            videoWidth, videoHeight + controlBarHeight, 10);        so.addParam("allowfullscreen", "true");        so.addParam("bgcolor", "black");        so.addVariable("autostart", autoplay);        //if (videoWidth <= 200) {        so.addParam("wmode", "opaque");        //}        if (hideControl) {            so.addVariable("controlbar", "none");        } else {            so.addVariable("controlbar", "bottom");        }        so.addVariable("file", movieUrl);        so.write(containerId);    }}function removePlayer(containerId) {    $("#" + containerId + "_qtembed").remove();    $("#" + containerId + "_qtobj").remove();    $("#" + containerId + "_flash").remove();}/* Notify */function hideNotify() {    $("#notify").slideUp();}function showNotify(message) {    $("#notifyText").html(message);    $("#notify").slideDown();    window.setTimeout("hideNotify();", 5000);}/* Checkout *//* Terms and conditions dialog */function showContentDialog(url, title, width, height) {    $("#dlg_frame").attr("src", url);    $("#dialog").dialog({        title: title,        width: width,        height: height,        position: ["center", "middle"],        modal: true,        buttons: {            Close: function () {                $(this).dialog("close");            }        }    });}function chkout(message) {    obj = document.getElementById("accept");    if (obj.checked) {        var url = host + "/en/cart/checkout.html";        document.forms.fcart.action = url;        return true;    }    else {        alert(message);        return false;    }}/* Add to cart and clip bin */function addToBin(link, href) {    link.unbind("click").click(function () {        return false;    });    //var reg = /id_(\d+)_type_(\d+)/    //var arr = reg.exec(id);    var href_arr = href.split('/');    //var item_id = arr[1];    //var item_type = arr[2];    var item_id = href_arr[href_arr.length - 1];    var item_type = href_arr[href_arr.length - 2];    $.ajax({        type: "POST",        url: href + '/1',        success: function (data) {            if ((typeof(parseInt(data)) == 'number') && (data > 0)) {                var binCount = document.getElementById('binCount');                binCount.innerHTML = parseInt(binCount.innerHTML) + 1;                var binSpan = document.getElementById('bin_' + item_id);                if (binSpan) {                    binSpan.innerHTML = '<img src="/data/img/bin_exist.png" title="This item is already in your clips">';                }                link.remove();                showNotify('Item has been successfuly added to your clips');            } else {                link.click(function () {                    addToBin(link, href);                    return false;                });            }        }    });}/*function addToCart(link, href) { link.unbind("click").click(function(){ return false; }); //var reg = /id_(\d+)_type_(\d+)/ //var arr = reg.exec(id); var href_arr = href.split('/'); //var item_id = arr[1]; //var item_type = arr[2]; var item_id = href_arr[href_arr.length - 1]; var item_type = href_arr[href_arr.length - 2]; $.ajax({ type: "POST", url: href + '/1', success: function(data){ if (data) { var cartCount = document.getElementById('cartCount'); cartCount.innerHTML = parseInt(cartCount.innerHTML) + 1; //var cartSpan = document.getElementById('cart_'+item_id); //cartSpan.innerHTML = '<img src="/data/img/cart_exist.jpg" alt="cart" class="cartImg" height="24" title="This item is already in your cart">'; } else { link.click(function(){ addToCart(link, href); return false; }); } } }); }*/function addToCartDialog() {    $('#addToCartForm').dialog({        title: jQuery.i18n.prop('tocart_form_title'),        width: 550,        modal: true,        buttons: [            {                text: jQuery.i18n.prop('clip_add'),                click: function () {                    var valid = true;                    $(this).find('.message').hide().removeClass('error');                    $(this).find('textarea').each(function () {                        if (!$(this).val()) {                            valid = false;                        }                    });                    if (!valid) {                        $(this).find('.message').addClass('error').show();                    }                    else {                        $.ajax({                            type: "POST",                            url: 'en/cart/add',                            data: $("#addToCartForm form").serialize(),                            success: function (data) {                                if (data) {                                    var cartCount = document.getElementById('cartCount');                                    cartCount.innerHTML = parseInt(cartCount.innerHTML) + parseInt(data);                                    showNotify('Item has been successfuly added to your cart');                                }                                else {                                    showNotify('This item is already in your cart');                                }                            }                        });                        $(this).dialog("close");                    }                }            },            {                text: jQuery.i18n.prop('clip_cancel'),                click: function () {                    $(this).dialog('close');                }            }        ]    });}function addToCartForm(items) {    $('#addToCartForm').dialog('destroy');    $('#addToCartForm form').html('');    var show_form = false;    if (items.length > 0) {        for (var i = 0; i < items.length; i++) {            if (items[i]['price'] == 0.00) {                show_form = true;                var label = $(document.createElement('label')).html(jQuery.i18n.prop('clip_intended_usage') + ' ' + items[i]['name']);                var field = $(document.createElement('textarea'))                    .attr('name', 'items[' + items[i]['id'] + '][usage]');                $('#addToCartForm form').append(label);                $('#addToCartForm form').append(field);            } else {                var priceField = $(document.createElement('input'))                    .attr('type', 'hidden')                    .attr('name', 'items[' + items[i]['id'] + '][price]')                    .attr('value', items[i]['price']);                $('#addToCartForm form').append(priceField);            }            var hfield = $(document.createElement('input'))                .attr('type', 'hidden')                .attr('name', 'items[' + items[i]['id'] + '][name]')                .attr('value', items[i]['name']);            $('#addToCartForm form').append(hfield);            if (items[i]['start_time']) {                var startField = $(document.createElement('input'))                    .attr('type', 'hidden')                    .attr('name', 'items[' + items[i]['id'] + '][start]')                    .attr('value', items[i]['start_time']);                $('#addToCartForm form').append(startField);            }            if (items[i]['end_time']) {                var endField = $(document.createElement('input'))                    .attr('type', 'hidden')                    .attr('name', 'items[' + items[i]['id'] + '][end]')                    .attr('value', items[i]['end_time']);                $('#addToCartForm form').append(endField);            }        }        if (show_form) {            addToCartDialog();        }        else {            $.ajax({                type: "POST",                url: 'en/cart/add',                data: $("#addToCartForm form").serialize(),                success: function (data) {                    if (data) {                        var cartCount = document.getElementById('cartCount');                        cartCount.innerHTML = parseInt(cartCount.innerHTML) + parseInt(data);                        showNotify('Item has been successfuly added to your cart');                    }                    else {                        showNotify('This item is already in your cart');                    }                }            });        }    }}function addToCart(link) {    var href = link.attr("href");    var href_arr = href.split('/');    var item_id = href_arr[href_arr.length - 1];    var himput = $('input[name="item-' + item_id + '"]');    var clip_info = eval("(" + himput.val() + ")");    if (clip_info) {        var item = new Array();        item['id'] = clip_info.id;        item['name'] = clip_info.title;        item['price'] = clip_info.price;        var start_time = $('input[name="startTime-' + item_id + '"]').val();        var end_time = $('input[name="endTime-' + item_id + '"]').val();        if (start_time) {            item['start_time'] = start_time;        }        if (end_time) {            item['end_time'] = end_time;        }        addToCartForm([item]);    }}function addDropedElement(timelineElement) {    var himput = $('#addClipItem');    var clip_info = eval("(" + himput.val() + ")");    if (clip_info) {        var item = new Array();        item['id'] = clip_info.id;        item['name'] = clip_info.title;        item['price'] = clip_info.price;        if (timelineElement.startOffset) {            item['start_time'] = timelineElement.startOffset;        }        if (timelineElement.stopOffset) {            item['end_time'] = timelineElement.stopOffset;        }        //console.log(item);        addToCartForm([item]);    }    /*console.log(timelineElement.startOffset);     console.log(timelineElement.stopOffset);     console.log(timelineElement.preview);     console.log(timelineElement.length_);     console.log(timelineElement.id);     console.log(timelineElement.muted);     console.log(timelineElement.filename);*/    /*timelineElement.preview + " " +     timelineElement.id + " " +     timelineElement.filename + " " +     timelineElement.length_ + " " +     timelineElement.muted + " " +     timelineElement.startOffset + " " +     timelineElement.stopOffset*/}function binToCart() {    if ($('input:checkbox[name="id[]"]:checked').length > 0) {        var items = [];        $('input:checkbox[name="id[]"]:checked').each(function () {            var iid_arr = $(this).val().split('-');            var iitem_id = iid_arr[1];            var himput = $('input[name="item-' + iitem_id + '"]');            var clip_info = eval("(" + himput.val() + ")");            if (clip_info) {                var item = new Array();                item['id'] = clip_info.id;                item['name'] = clip_info.title;                item['price'] = clip_info.price;                items.push(item);            }        });        addToCartForm(items);    }}function checkPhrase(adv) {    var elemId = adv ? "words" : "phrase";    var elem = document.getElementById(elemId);    if (elem && elem.value && elem.value.replace(" ", "") && elem.value != 'Type some keywords') {        return true;    }    else {        if (elem) {            elem.focus();        }        return false;    }}jQuery(document).ready(function () {    jQuery('.boxgrid.caption').hover(function () {        jQuery(".cover", this).stop().animate({bottom: '0px'}, {queue: false, duration: 160});    }, function () {        jQuery(".cover", this).stop().animate({bottom: '-40px'}, {queue: false, duration: 160});    });});